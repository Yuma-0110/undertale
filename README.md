# README.md

ディレクトリ構造:

```text
undertale/
    fonts/  # ゲーム内にて読み込まれるフォント群
    images/  # ゲーム内にて読み込まれる画像群
    original_images/  # ゲーム内では読み込まれない画像群 (Git管理対象外)
    src/  # 動作確認済みのコード群 (from src.module import xx の形で使う)
    undertale.py  # ./undertale.py で実行するゲーム本体
```

画像の透明度の設定

```python
# 画像を読み込む
image = pygame.image.load("image.png")

# 透明度を設定する
# 透明度は、0（完全に透明）から255（完全に不透明）までの整数値で指定する
image.set_alpha(alpha_value)
```

参考リンク:

[気持ちのいいジャンプを目指して](https://qiita.com/odanny/items/297f32a334c41410cc5d)
[Pythonリスト内包表記の使い方 | note.nkmk.me](https://note.nkmk.me/python-list-comprehension/)
[ゲームオーバー画面 - 人工知能に関する断創録](https://aidiary.hatenablog.com/entry/20081012/1281193197)
[【備忘録】Pygameでのテキスト入力処理サンプル(ただし機能は限定的)【Python】 - Qiita](https://qiita.com/kedama_nth/items/7e6e80ce98fe070ab23e)

---

# TODO / 授業記録

## 2022-09-25 亀井

おさらい:
下記3点に重きを置いて、リファクタリングの考え方とその実践について指導しました。

- グローバル変数を最低限に減らす
- 変数のスコープを狭める
- 完成している実装とバグを含む未完成の実装を分ける

引き継ぎ:
赤ハートの動きやメニューの描写などの完成済みの処理は、状態変数を引数に取る個別の関数に切り出してあります。
次回は、物理法則をコードに落とし込み、青ハートのジャンプ処理 `undertale.py/update_blue_heart()` を作っていきます。
試行錯誤中の現在のコードでは上手く動かないようです。

現在の `main(): while True` 内の実装では毎フレームごとに描写しています。
一方、ジャンプの場合は「ジャンプ実行」のキーボード操作を受け付けた瞬間に向こう数フレームの描写が確定するため、
「ジャンプ中かどうか」・「ジャンプの何フレーム目か」などの新たな状態変数を調整する必要がありそうです。

ジャンプの力学に関する参考記事:
<https://qiita.com/odanny/items/297f32a334c41410cc5d>

## 2022-10-09 亀井

is_jumping 変数を追加することで青ハートのジャンプ動作を実現しました。

動作確認済みの処理は関数化してsrc/functions.pyに移してあります。

次回は攻撃動作を作っていきます。

## 2022-10-16 亀井

`functions.py/update_bone_view()`に敵の骨の挙動を作っています。

次回は骨の出現位置とハート()

functionspy/update_bone_view()`

## 2022-12-04 亀井

前回に引き続き、`functions.py/update_bone_view()`に敵の骨の挙動を考えました。
次回は、

- `undertale.py` 87行目の修正 (`update_bone_view(screen, heart_x, heart_y)  # 次回これ実行できないの治す`)
- HPバーを固定から数値に応じて代わるように変更

## 2023-02-12 亀井

前回に引き続き、敵の骨の挙動を考え 2 つの関数を追加しました。

- generate_bone_view():
    現時点でのプレイヤーの座標とランダムに生成された敵の初期座標を元に
    敵が近づいてくるときのフレームごとの座標をリストとして返す関数
- update_bone_view():
    プレイヤーの座標, 敵の座標を元に当たり判定と敵の描写更新を行う関数

次回は、

x 当たり判定を調節する

- HP が 0 になったときの処理を追加する
x クリティカルヒットのごとく大ダメージが入ってしまう挙動を修正する
x スクリーンから画像オブジェクトを削除する処理を調べる

## 2023-02-19 亀井

- generate_bone_view() の修正:
    画面の枠外までの移動座標をまとめて生成するように変更
- game_over() / Mode.GAMEOVER の追加:
    HP が 0 になったときのゲームオーバー処理と画面描写を追加
- pygame.transform.scale(描写オブジェクト: Surface型, (横幅: int, 縦幅: int)) で画像の拡大縮小ができる

次回、

- 重心ではなく画像オブジェクトの左上の座標が使われていると思われるため、 update_bone_view() の当たり判定を if 0<=x<=w and 0<=y<=h のように変更する
- ゲームオーバーからのコンティニュー処理を追加する

## 2023-02-26 亀井

- ゲームオーバー後、F3押下による画面終了処理 `pygame.quit(); sys.exit()`
- 画面終了を促すテキストの表示 `font.render()`

次回、

- functions.game_over() にゲームオーバー画面の表示・テキスト表示を移行して、undertale.pyでは呼び出し・F3監視のみにする
- 現在、functions.update_constant_view()内にgameoverテキストのレンダリング済みオブジェクトを作成途中のため、それを仕上げた後 constants.py に移行する

## 2023-03-05 亀井

- 警告処理の実装
- 2 つ目の敵の挙動の実装

次回、

- 攻撃の際にハートを最前面に表示するようにする
  - もしくは、セーフゾーンの透明度を下げてハートが見えるようにする

## 2023-03-12 亀井

- セーフゾーンの描写改良
- 2つの攻撃モードのリファクタリング

ガスターブラスターの画像やる
こうげきつくる
ITぱすぽーとやる
さいとうゆうま

## 2023-05-28 菅生 (written by Yuma)

次はITパスポートとこれ
sans_attack3実行したときのgasterblaster_imageの大きさ、向き、表示場所調整する。

1:gasterblaster_image表示
2:もう一つgasterblaster_imageみたいな画像表示
3:図形描画
の手順で攻撃作る

## 2023-06-11 亀井

1:gasterblaster_image表示
2:30ミリ秒おきの描画をつかって時間差で攻撃(白い長方形)を表示
3:繰り返す
をできる限り作るのとITパスポート

## 2023-07-09 池澤
sans_attack_1を改善するか新しい攻撃を作るかITパスポートかchatgptをやるか。

## 2023-07-23 池澤
操作方法の変更かITパスポート